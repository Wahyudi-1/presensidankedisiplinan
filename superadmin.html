<!DOCTYPE html>
<html lang="id">
<head>
    <!-- ========================================================== -->
    <!-- METADATA & PAGE CONFIGURATION                              -->
    <!-- ========================================================== -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Panel Super Admin - Manajemen Sekolah & Pengguna">
    <title>Panel Super Admin - Kak Rose</title>

    <!-- ========================================================== -->
    <!-- ASSETS (FONTS & STYLE)                                     -->
    <!-- ========================================================== -->
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Main Stylesheet (Shared with Dashboard) -->
    <link rel="stylesheet" href="style.css">

    <!-- Favicon -->
    <link rel="icon" href="https://raw.githubusercontent.com/Wahyudi-1/presensidankedisiplinan/main/Logo.png">
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/Wahyudi-1/presensidankedisiplinan/main/Logo.png">
</head>

<body>

    <!-- ========================================================== -->
    <!-- HEADER                                                     -->
    <!-- ========================================================== -->
    <header>
        <div class="logo">
            <span style="font-weight: 300; color: var(--text-light); font-size: 0.9em;">Panel</span>
            Super Admin
        </div>
        <nav>
            <span id="welcomeMessage" style="margin-right: 20px; color: var(--text-light); font-size: 0.9em;">Memuat akses...</span>
            <button id="logoutButton" class="btn btn-sm btn-danger">
                Logout
            </button>
        </nav>
    </header>

    <!-- ========================================================== -->
    <!-- MAIN CONTENT                                               -->
    <!-- ========================================================== -->
    <main class="container">
        
        <!-- Global Notification Area -->
        <div id="statusMessage" class="status-message" style="display: none;"></div>
        
        <!-- Global Loading Spinner -->
        <div id="loadingIndicator" class="loading-overlay" style="display: none;">
            <div class="spinner"></div>
            <p style="margin-top: 15px; color: var(--primary-color);">Memproses Data...</p>
        </div>

        <h2 style="margin-bottom: 1.5rem; color: var(--text-color);">Manajemen Sistem Global</h2>

        <!-- ====================================================== -->
        <!-- Section 1: SCHOOL MANAGEMENT                           -->
        <!-- ====================================================== -->
        <div class="card">
            <div class="card-header">1. Manajemen Sekolah (Tenant)</div>
            
            <!-- ==== IMPROVEMENT HERE: Add/Edit School Form ==== -->
            <form id="formTambahSekolah" class="form-grid" style="border-bottom: 1px dashed var(--border-color); padding-bottom: 1.5rem; margin-bottom: 1.5rem;">
                
                <!-- Hidden input to store the ID during edit mode -->
                <input type="hidden" id="schoolIdInput">
                
                <div class="form-group">
                    <label for="schoolNameInput">Nama Sekolah</label>
                    <input type="text" id="schoolNameInput" placeholder="Contoh: SMA Negeri 1 Maju Jaya" required>
                </div>
                
                <div class="form-group">
                    <label for="schoolSlugInput">Slug URL (Wajib Unik)</label>
                    <input type="text" id="schoolSlugInput" placeholder="cth: sman1maju (tanpa spasi)" required>
                </div>

                <div class="form-group">
                    <label for="schoolLogoInput">URL Logo (Opsional)</label>
                    <input type="url" id="schoolLogoInput" placeholder="https://.../logo.png">
                </div>

                <div class="form-group form-group-full" style="text-align: right; display: flex; gap: 10px; justify-content: flex-end;">
                    <!-- Cancel button, appears during edit mode -->
                    <button type="button" id="cancelEditButton" class="btn btn-secondary" style="display: none;">Batal</button>
                    
                    <!-- Main submit button -->
                    <button type="submit" id="submitSchoolButton" class="btn btn-primary">+ Tambah Sekolah</button>
                </div>
            </form>
            <!-- ==== END OF IMPROVEMENT ==== -->

            <!-- School List Table -->
            <h4>Daftar Sekolah Terdaftar</h4>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Nama Sekolah</th>
                            <th>Slug</th>
                            <th>Logo</th>
                            <th style="width: 200px; text-align: right;">Aksi</th>
                        </tr>
                    </thead>
                    <tbody id="schoolsTableBody">
                        <tr><td colspan="4" style="text-align: center; padding: 20px;">Memuat data sekolah...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ====================================================== -->
        <!-- Section 2: USER MANAGEMENT                           -->
        <!-- ====================================================== -->
        <div class="card" style="margin-top: 2rem;">
            <div class="card-header">2. Manajemen Pengguna (Admin Sekolah)</div>
            
            <!-- Create User Form -->
            <div style="background-color: var(--secondary-color); padding: 1.5rem; border-radius: 8px; margin-bottom: 1.5rem;">
                <form id="formPengguna" class="form-grid">
                    <div class="form-group">
                        <label for="userEmail">Email Pengguna Baru</label>
                        <input type="email" id="userEmail" placeholder="email@sekolah.sch.id" required autocomplete="off">
                    </div>
                    
                    <div class="form-group">
                        <label for="userPassword">Password Awal</label>
                        <input type="password" id="userPassword" placeholder="Min. 6 karakter" required minlength="6" autocomplete="new-password">
                    </div>
                    
                    <div class="form-group">
                        <label for="userSchoolLink">Tautkan ke Sekolah</label>
                        <select id="userSchoolLink" required>
                            <option value="">-- Sedang memuat daftar sekolah... --</option>
                        </select>
                    </div>

                    <div class="form-group form-group-full" style="text-align: right;">
                        <button type="submit" class="btn btn-success">
                            + Buat & Tautkan Pengguna
                        </button>
                    </div>
                </form>
            </div>

            <!-- User List Table -->
            <h4>Daftar Pengguna Sistem</h4>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Email Pengguna</th>
                            <th>Sekolah Tertaut</th>
                            <th style="text-align: right;">Aksi</th>
                        </tr>
                    </thead>
                    <tbody id="usersTableBody">
                        <tr><td colspan="3" style="text-align: center; padding: 20px;">Memuat data pengguna...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

    </main>

    <!-- ========================================================== -->
    <!-- SCRIPT & LIBRARY                                           -->
    <!-- ========================================================== -->
    
    <!-- Supabase Client -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Main Logic (Router will call app-admin.js) -->
    <script type="module" src="main.js"></script>

</body>
</html>
