<!DOCTYPE html>
<html lang="id">
<head>
    <!-- ========================================================== -->
    <!-- METADATA & KONFIGURASI HALAMAN                             -->
    <!-- ========================================================== -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Portal Login Sistem Kedisiplinan dan Presensi Siswa">
    <meta name="author" content="Kak Rose Team">
    <title>Login - Sistem Kedisiplinan Siswa</title>

    <!-- ========================================================== -->
    <!-- ASSETS (FONTS & STYLE)                                     -->
    <!-- ========================================================== -->
    
    <!-- Google Fonts (Poppins) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="style.css">

    <!-- Favicon -->
    <link rel="icon" href="https://raw.githubusercontent.com/Wahyudi-1/presensidankedisiplinan/main/Logo.png">
    <link rel="apple-touch-icon" href="https://raw.githubusercontent.com/Wahyudi-1/presensidankedisiplinan/main/Logo.png">
    <meta name="apple-mobile-web-app-title" content="Presensi Digital">
</head>

<body class="login-page-v2">

    <!-- ========================================================== -->
    <!-- MAIN LOGIN CONTAINER                                       -->
    <!-- ========================================================== -->
    <main class="login-box">
        
        <!-- KOLOM KIRI: ILUSTRASI -->
        <div class="login-illustration">
            <div class="illustration-content">
               <img 
                    class="responsive-icon"
                    src="https://raw.githubusercontent.com/Wahyudi-1/presensidankedisiplinan/main/Logo.png" 
                    alt="Logo Aplikasi Kak Rose"
                    style="max-width: 180px; margin-bottom: 20px;"
                >
                <h3 style="font-weight: 600; color: var(--primary-dark);">Sistem Presensi Digital</h3>
                <h3 style="font-weight: 700; color: var(--primary-color);">Kak Rose</h3>
                <p style="margin-top: 15px; font-size: 0.95rem; color: #555;">
                    Platform manajemen kedisiplinan siswa yang Cepat, Akurat, dan Terintegrasi WhatsApp.
                </p>
            </div>
        </div>
        
        <!-- KOLOM KANAN: FORM LOGIN -->
        <div class="login-form-container">
            <div class="login-form-content">
                
                <!-- ====================================================== -->
                <!-- ==== PERBAIKAN DI SINI: HEADER DINAMIS              ==== -->
                <!-- ====================================================== -->
                <div style="text-align: center; margin-bottom: 30px;">
                    <!-- WADAH UNTUK LOGO DINAMIS -->
                    <img 
                        id="schoolLogo" 
                        src="https://raw.githubusercontent.com/Wahyudi-1/presensidankedisiplinan/main/Logo.png" 
                        alt="Logo Sekolah" 
                        style="max-height: 80px; margin-bottom: 1rem; object-fit: contain;">
                    
                    <!-- WADAH UNTUK NAMA SEKOLAH DINAMIS -->
                    <h2 
                        id="schoolName" 
                        class="logo" 
                        style="color: var(--primary-color); font-size: 1.5rem; line-height: 1.2;">
                        Selamat Datang
                    </h2>
                    
                    <p style="color: var(--text-light);">Silakan masuk ke akun Anda.</p>
                </div>
                <!-- ====================================================== -->
                <!-- ==== AKHIR PERBAIKAN                                ==== -->
                <!-- ====================================================== -->
                
                <form id="loginForm" novalidate>
                    
                    <div class="form-group">
                        <label for="username">Alamat Email</label>
                        <input 
                            type="email" 
                            id="username" 
                            placeholder="admin@sekolah.com" 
                            required 
                            autocomplete="email"
                            autofocus
                        >
                    </div>
                    
                    <div class="form-group">
                        <label for="password">Kata Sandi</label>
                        <div class="password-wrapper">
                            <input 
                                type="password" 
                                id="password" 
                                placeholder="Masukkan password..." 
                                required 
                                autocomplete="current-password"
                            >
                            <!-- Ikon mata akan di-inject oleh utils.js -->
                            <span id="togglePassword" class="toggle-password-icon" title="Lihat Password"></span>
                        </div>
                    </div>
                    
                    <!-- Tombol Aksi -->
                    <div class="form-group" style="margin-top: 2rem;">
                        <button type="submit" id="loginButton" class="btn btn-primary btn-block">
                            Masuk Aplikasi
                        </button>
                    </div>

                    <div class="form-group" style="text-align: center; margin-top: 1.5rem;">
                        <a href="#" id="forgotPasswordLink" style="color: var(--text-light); text-decoration: none; font-size: 0.9em; transition: color 0.3s;">
                            Lupa Password?
                        </a>
                    </div>

                </form>
                
                <!-- Area Pesan Error/Sukses -->
                <div id="statusMessage" class="status-message" style="display: none; margin-top: 20px;"></div>

            </div>
        </div>

    </main>

    <!-- ========================================================== -->
    <!-- KONTAINER RESET PASSWORD (DEFAULT: HIDDEN)                 -->
    <!-- ========================================================== -->
    <div id="resetPasswordContainer" class="login-box" style="display: none; height: auto; min-height: 400px;">
        <div class="login-form-container" style="grid-column: 1 / -1; width: 100%;">
            <div class="login-form-content" style="text-align: center;">
                
                <h2 class="logo" style="color: var(--primary-color);">Atur Password Baru</h2>
                <p style="color: var(--text-light); margin-bottom: 25px;">Masukkan kata sandi baru untuk akun Anda.</p>
                
                <form id="resetPasswordForm">
                    <div class="form-group" style="text-align: left;">
                        <label for="newPassword">Password Baru</label>
                        <div class="password-wrapper">
                            <input 
                                type="password" 
                                id="newPassword" 
                                placeholder="Minimal 6 karakter..." 
                                required 
                                minlength="6"
                                autocomplete="new-password"
                            >
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-top: 2rem;">
                        <button type="submit" class="btn btn-primary btn-block">Simpan Perubahan</button>
                    </div>
                </form>

            </div>
        </div>
    </div>

    <!-- ========================================================== -->
    <!-- LOADING SPINNER GLOBAL                                     -->
    <!-- ========================================================== -->
    <div id="loadingIndicator" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p style="margin-top: 15px; font-weight: 500; color: var(--primary-color);">Memproses...</p>
    </div>

    <!-- ========================================================== -->
    <!-- SCRIPT & LIBRARY                                           -->
    <!-- ========================================================== -->
    
    <!-- Library Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- Script Utama (Type Module agar import/export jalan) -->
    <script type="module" src="main.js"></script>

</body>
</html>
